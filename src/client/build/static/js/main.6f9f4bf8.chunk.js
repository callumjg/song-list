(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[0],{30:function(e,t,a){e.exports=a.p+"static/media/logo.f48b0626.jpg"},37:function(e,t,a){e.exports=a(80)},42:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(10),l=a.n(r),s=a(11),o=a(12),i=a(34),u=a(29),m=a(35),d=a(84),f=a(7),E=Object(f.a)(),b=(a(42),function(e){return c.a.createElement("nav",null,c.a.createElement("ul",null,c.a.createElement("li",{onClick:function(){return E.push("/")}},"Songs"),c.a.createElement("li",{onClick:function(){return E.push("/metrics")}},"Metrics"),c.a.createElement("li",{onClick:function(){return E.push("/services")}},"Services")))}),g=a(30),v=a.n(g),p=(a(43),function(e){return c.a.createElement("div",{className:"brand"},c.a.createElement("img",{src:v.a,alt:"Graceville Presbyterian Church"}))}),y=(a(44),function(e){return c.a.createElement("header",null,c.a.createElement("div",{className:"container"},c.a.createElement(p,null),c.a.createElement(b,null)))}),h=a(1),j=a(8),O=a.n(j),N=a(13),S=a(31),k=a.n(S).a.create({baseURL:"/api/v1"});function C(e,t){var a=Object(n.useState)(t),c=Object(h.a)(a,2),r=c[0],l=c[1],s=Object(n.useState)(null),o=Object(h.a)(s,2),i=o[0],u=o[1],m=Object(n.useState)(!1),d=Object(h.a)(m,2),f=d[0],E=d[1];return Object(n.useEffect)(function(){e&&Object(N.a)(O.a.mark(function t(){var a,n;return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return E(!0),t.prev=1,t.next=4,k.get(e);case 4:a=t.sent,l(a.data),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0),n=t.t0.response?t.t0.response.data.message:t.t0.message,u(n);case 13:E(!1);case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()},[e]),[e?r:t,i,f]}var x=function(e){var t=e.search,a=e.setSearch;return c.a.createElement("div",{className:"mt-3"},c.a.createElement("input",{type:"text",className:"form-control ",placeholder:"Search title or author...",value:t,onChange:function(e){return a(e.target.value)}}))},w=a(15),L=function(){function e(t,a){Object(s.a)(this,e),this.tags=t,this.exclude=a}return Object(o.a)(e,[{key:"_addItem",value:function(e,t){var a=e.toLowerCase();this[t].includes(a)||(this[t]=[].concat(Object(w.a)(this[t]),[a]))}},{key:"_removeItem",value:function(e,t){var a=e.toLowerCase();this[t]=this[t].filter(function(e){return e!==a})}},{key:"addTag",value:function(e){return this._addItem(e,"tags"),this.removeExclude(e),this}},{key:"addExclude",value:function(e){return this._addItem(e,"exclude"),this.removeTag(e),this}},{key:"removeTag",value:function(e){return this._removeItem(e,"tags"),this}},{key:"removeExclude",value:function(e){return this._removeItem(e,"exclude"),this}},{key:"getTags",value:function(){return this.tags}},{key:"getExclude",value:function(){return this.exclude}}]),e}(),A=function(e){var t=e.tags,a=e.setTags,r=e.exclude,l=e.setExclude,s=new L(t,r),o=Object(n.useState)("Category A"),i=Object(h.a)(o,2),u=i[0],m=i[1],d=["Category A","Category B (Hymn)"],f="btn btn-outline-primary no-glow btn-sm",E=Object(n.useState)(""),b=Object(h.a)(E,2),g=b[0],v=b[1];function p(e){return u===e?f+" active":f}return c.a.createElement("div",{className:"my-3"},c.a.createElement("div",{className:"btn-group btn-group-toggle"},d.map(function(e,t){return c.a.createElement("button",{className:p(e),onClick:function(){return function(e){m(e),s.addTag(e).addExclude(e===d[0]?d[1]:d[0]),a(s.getTags()),l(s.getExclude())}(e)},key:t},e)})),c.a.createElement("button",{className:f+g+" ml-2",onClick:function(){g?(v(""),a(s.addExclude("archived").getTags()),l(s.getExclude())):(v(" active"),a(s.addTag("archived").getTags()),l(s.getExclude()))}},c.a.createElement("i",{className:"ui archive icon"})," Archived"))},P=function(e){var t=e.page,a=e.pagesNum,n=e.setPage;if(a<2)return null;for(var r=[],l=function(e){r.push(c.a.createElement("button",{className:"btn btn-sm no-glow btn-outline-secondary".concat(e===t+1?" active":""),onClick:function(){return n(e-1)},key:e},e))},s=1;s<=a;s++)l(s);return c.a.createElement("div",{className:"d-flex justify-content-center"},c.a.createElement("div",{className:"btn-group btn-group-toggle"},r))},D=(a(63),function(e){var t=e.song;return c.a.createElement("tr",{className:"song-row"},c.a.createElement("td",null,t.title),c.a.createElement("td",null,t.author),c.a.createElement("td",null,t.key),c.a.createElement("td",null,t.tags.filter(function(e){return!e.match(/category a/i)&&!e.match(/category b/i)}).join(", ")),c.a.createElement("td",null,c.a.createElement("a",{href:t.url,target:"_blank",rel:"noopener noreferrer"},c.a.createElement("i",{className:"ui youtube icon"}))))}),T=(a(64),function(e){var t=e.songs;return c.a.createElement("table",{className:"table songs-table"},c.a.createElement("thead",{className:""},c.a.createElement("tr",null,c.a.createElement("th",null,"Title"),c.a.createElement("th",null,c.a.createElement("i",{className:"ui user icon"})),c.a.createElement("th",null,c.a.createElement("i",{className:"ui key icon"})),c.a.createElement("th",null,c.a.createElement("i",{className:"ui tags icon"})),c.a.createElement("th",null,c.a.createElement("i",{className:"ui chain icon"})))),c.a.createElement("tbody",null,t.map(function(e){return c.a.createElement(D,{key:e._id,song:e})})))});a(65);var M=function(e){var t=Object(n.useState)(""),a=Object(h.a)(t,2),r=a[0],l=a[1],s=Object(n.useState)(0),o=Object(h.a)(s,2),i=o[0],u=o[1],m=Object(n.useRef)(null);return Object(n.useEffect)(function(){u(m.current.offsetHeight)},[]),Object(n.useEffect)(function(){function e(){window.scrollY>i?l(" stuck"):l("")}return i&&document.addEventListener("scroll",e),function(){return document.removeEventListener("scroll",e)}},[i]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"sticky".concat(r),ref:m},"function"===typeof e.children?e.children(r):e.children),r&&c.a.createElement("div",{style:{height:i}}))},R=function(e){var t=e.setLimit,a=e.limitButtons,n=e.setPage,r=e.limit;return c.a.createElement("div",{className:"mb-3"},c.a.createElement("span",{className:"mr-2"},"Limit: "),c.a.createElement("div",{className:"btn-group btn-group-toggle"},a.map(function(e,a){return c.a.createElement("button",{className:"btn btn-sm no-glow btn-outline-secondary".concat(r===e?" active":""),key:a,onClick:function(){return t(e),void n(0)}},e)})))},_=(a(66),function(e){return e.loading?c.a.createElement("div",null,c.a.createElement("div",{className:"loader"},c.a.createElement("div",null)),e.children):e.children}),Y=(a(67),function(e){var t=Object(n.useState)(50),a=Object(h.a)(t,2),r=a[0],l=a[1],s=Object(n.useState)(0),o=Object(h.a)(s,2),i=o[0],u=o[1],m=Object(n.useState)(["category a"]),d=Object(h.a)(m,2),f=d[0],E=d[1],b=Object(n.useState)(["archived","deleted"]),g=Object(h.a)(b,2),v=g[0],p=g[1],y=Object(n.useState)(""),j=Object(h.a)(y,2),O=j[0],N=j[1],S=Object(n.useState)(""),k=Object(h.a)(S,2),w=k[0],L=k[1],D=Object(n.useState)(!1),Y=Object(h.a)(D,2),B=Y[0],I=Y[1],q=Object(n.useState)(null),V=Object(h.a)(q,2),H=V[0],F=V[1];var J=C(function(){var e="/songs?limit=".concat(r);return"number"===typeof r&&(e+="&skip=".concat(r*i)),f.length&&(e+="&tags=".concat(f.map(function(e){return e.toLowerCase()}).join(","))),v.length&&(e+="&exclude=".concat(v.map(function(e){return e.toLowerCase()}).join(","))),O&&(e+="&search=".concat(O)),e}(),{count:0,songs:[]}),W=Object(h.a)(J,3),G=W[0],K=G.count,U=G.songs,z=W[1],Q=W[2];function X(e){I(!0),L(e),clearTimeout(H),F(setTimeout(function(){N(e),I(!1)},100))}return c.a.createElement("section",{className:"songs-list relative my-3"},c.a.createElement("h4",null,"Songs"),c.a.createElement(M,null,function(e){return c.a.createElement("section",{className:"controls".concat(e)},c.a.createElement("div",{className:e?"container":""},c.a.createElement(x,{search:w,setSearch:X}),c.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},c.a.createElement(A,{tags:f,setTags:E,exclude:v,setExclude:p}),c.a.createElement(R,{limit:r,setLimit:l,setPage:u,limitButtons:[10,30,50,100,"All"]}))))}),z&&c.a.createElement("p",{className:"alert alert-danger my-2 p-2"},z),c.a.createElement("div",{className:"relative"},c.a.createElement(_,{loading:Q||B},c.a.createElement(T,{songs:U}))),c.a.createElement(P,{page:i,pagesNum:Math.ceil(K/r),setPage:u}))}),B=(a(68),function(e){return c.a.createElement("div",{className:"container py-3"},c.a.createElement(Y,null))}),I=a(83);a(69);var q=function(e){return c.a.createElement("table",{className:"table services-table"},c.a.createElement("tbody",null,e.services.map(function(e){return c.a.createElement("tr",{key:e._id},c.a.createElement("td",{style:{width:"60%"}},Object(I.a)(new Date(e.date),"dd/MM/yyyy"),c.a.createElement("ol",null,e.songs.map(function(e,t){return c.a.createElement("li",{key:t},e.title)}))),c.a.createElement("td",null,e.tags&&c.a.createElement("ul",null,e.tags.map(function(e,t){return c.a.createElement("li",{key:t},e)}))))})))};var V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object(n.useReducer)(function(e,a){var n=a.type,c=a.payload;switch(console.log(e),n){case"ADD":return[].concat(Object(w.a)(e),[c]);case"REMOVE":return console.log(c),e.filter(function(e,a){return t.target?e[t.target]!==c:a!==c});case"CLEAR":return[];default:return e}},e),c=Object(h.a)(a,2);return[c[0],c[1],{ADD:"ADD",REMOVE:"REMOVE",CLEAR:"CLEAR"}]};a(70);var H=function(e){var t=Object(n.useState)(" open"),a=Object(h.a)(t,2),r=a[0],l=a[1];return Object(n.useEffect)(function(){e.songs.length||e.isLoading?l(" open"):l("")},[e.songs]),c.a.createElement("div",{className:"song-selector".concat(r)},c.a.createElement(_,{loading:e.isLoading},c.a.createElement("div",{className:"song-selector-container"},e.songs.map(function(t){return c.a.createElement("div",{key:t._id,onClick:function(){return a=t,e.onSelect(a),l(""),void console.log(e);var a}},t.title,c.a.createElement("i",{className:"ui plus icon"}))}))))};a(71);var F=function(e){var t=Object(n.useState)(""),a=Object(h.a)(t,2),r=a[0],l=a[1],s=V([],{target:"_id"}),o=Object(h.a)(s,3),i=o[0],u=o[1],m=o[2],d=Object(n.useState)(""),f=Object(h.a)(d,2),E=f[0],b=f[1],g=C(Object(n.useMemo)(function(){return r.length<3?null:"/songs?limit=5&search=".concat(r)},[r])),v=Object(h.a)(g,3),p=v[0],y=(v[1],v[2]),j=p?p.songs:[];return c.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onSubmit({songs:i,date:E})},className:"service-form container"},c.a.createElement("section",{className:"form-group"},c.a.createElement("label",null,"Date"),c.a.createElement("input",{className:"form-control",type:"date",required:!0,value:E,onChange:function(e){return b(e.target.value)}})),c.a.createElement("section",null,c.a.createElement("label",null,"Songs"),i.length?c.a.createElement("ol",{className:"songs-list"},i.map(function(e){var t=e.title,a=e._id;return c.a.createElement("li",{key:a},t,c.a.createElement("button",{className:"btn btn-sm btn-outline-danger"},c.a.createElement("i",{className:"ui trash icon",onClick:function(){return u({type:m.REMOVE,payload:a})}})))})):c.a.createElement("div",{className:"alert alert-info"},"No songs added")),c.a.createElement("section",{className:"search form-group"},c.a.createElement("input",{type:"text",value:r,onChange:function(e){return l(e.target.value)},className:"form-control",placeholder:"Search songs..."}),c.a.createElement(H,{songs:j,isLoading:y,onSelect:function(e){return u({type:m.ADD,payload:e})}})),c.a.createElement("section",{className:"d-flex justify-content-end"},c.a.createElement("button",{className:"btn btn-sm btn-outline-primary mr-2"},"Save"),c.a.createElement("button",{type:"button",onClick:e.onDismiss,className:"btn btn-sm btn-outline-info mr-2"},"Cancel"),c.a.createElement("button",{type:"button",onClick:function(){return u({type:m.CLEAR})},className:"btn btn-sm btn-outline-secondary"},"Clear")))},J=function(e){var t=e.title,a=e.onDismiss;return c.a.createElement("div",{className:t?"modal-header":"container-fluid p-2"},t&&c.a.createElement("h5",{className:"modal-title"},t),c.a.createElement("button",{type:"button",className:"close",onClick:a},c.a.createElement("span",{"aria-hidden":"true"},"\xd7")))},W=function(e){var t=e.footer;return t?c.a.createElement("div",{className:"modal-footer"},t):null},G=function(e){var t=document.querySelector("body"),a=Object(n.useState)("none"),r=Object(h.a)(a,2),s=r[0],o=r[1],i=Object(n.useState)(""),u=Object(h.a)(i,2),m=u[0],d=u[1];Object(n.useEffect)(function(){return e.isOpen&&(t.classList.add("modal-open"),f()),e.isOpen||(E(),t.classList.remove("modal-open")),function(){return t.classList.remove("modal-open")}},[e.isOpen,t.classList]);var f=function(){o("block"),setTimeout(function(){d(" show")},50)},E=function(){d(""),setTimeout(function(){o("none")},100)};return l.a.createPortal(c.a.createElement("div",null,c.a.createElement("div",{className:"modal-backdrop fade".concat(m),style:{display:s}}),c.a.createElement("div",{className:"modal fade".concat(m),onClick:e.onDismiss,style:{display:s}},c.a.createElement("div",{className:"modal-dialog modal-dialog-centered ".concat(e.large?"modal-lg":""," ").concat(e.small?"modal-sm":""),onClick:function(e){return e.stopPropagation()}},c.a.createElement("div",{className:"modal-content",onSubmit:function(e){return e.stopPropagation()}},c.a.createElement(J,{title:e.title,onDismiss:e.onDismiss}),c.a.createElement("div",{className:"modal-body"},e.children),c.a.createElement(W,{footer:e.footer}))))),document.querySelector("#modal"))};var K=function(e){var t=Object(n.useState)(10),a=Object(h.a)(t,2),r=a[0],l=a[1],s=Object(n.useState)(0),o=Object(h.a)(s,2),i=o[0],u=o[1],m=Object(n.useState)(!1),d=Object(h.a)(m,2),f=d[0],E=d[1],b=Object(n.useState)(!1),g=Object(h.a)(b,2),v=(g[0],g[1]),p=Object(n.useState)(""),y=Object(h.a)(p,2),j=(y[0],y[1]),S=C(Object(n.useMemo)(function(){var e="/services?limit=".concat(r);return"number"===typeof r&&(e+="&skip=".concat(r*i)),e},[r,i]),{count:0,services:[]}),x=Object(h.a)(S,3),w=x[0],L=w.count,A=w.services,D=x[1],T=x[2];function M(){return(M=Object(N.a)(O.a.mark(function e(t){var a,n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.prev=1,e.next=4,k.post("/services",t);case 4:a=e.sent,console.log(a),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),n=e.t0.response?e.t0.response.data.message:e.t0.message,j(n);case 12:v(!1);case 13:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}return c.a.createElement("section",{className:"container relative py-3"},c.a.createElement("h4",null,"Services"),D&&c.a.createElement("p",{className:"alert alert-danger my-2 p-2"},D),c.a.createElement("div",{className:"d-flex justify-content-between align-items-start"},c.a.createElement("button",{className:"btn btn-sm btn-outline-primary",onClick:function(){return E(!0)}},c.a.createElement("i",{className:"ui plus icon"})," Add Service"),c.a.createElement(R,{limit:r,setLimit:l,setPage:u,limitButtons:[5,10,20]})),c.a.createElement("div",{className:"relative"},c.a.createElement(_,{loading:T},c.a.createElement(q,{services:A}))),c.a.createElement(P,{page:i,pagesNum:Math.ceil(L/r),setPage:u}),c.a.createElement(G,{isOpen:f,onDismiss:function(){return E(!1)},large:!0,title:"New Service"},c.a.createElement(F,{onDismiss:function(){return E(!1)},onSubmit:function(e){return M.apply(this,arguments)}})))};var U=function(e){var t=[["Category A",function(){return e.setCategory(/Category A/i)}],["Category B (Hymn)",function(){return e.setCategory(/Category B/gi)}]];return c.a.createElement("div",{className:"btn-group btn-group-toggle"},t.map(function(t,a){var n=Object(h.a)(t,2),r=n[0],l=n[1];return c.a.createElement("button",{key:a,type:"button",onClick:l,className:"btn btn-sm btn-outline-primary no-glow".concat(r.match(e.category)?" active":"")},r)}))},z=a(82),Q=a(85);a(72);var X=function(e){return c.a.createElement("div",{className:"btn-group btn-group-toggle"},[["Total","total"],["2 Years","2 years"],["1 Year","1 year"],["6 Months","6 months"],["3 Months","3 months"],["1 Month","1 month"]].map(function(t,a){var n=Object(h.a)(t,2),r=n[0],l=n[1];return c.a.createElement("button",{key:a,type:"button",onClick:function(){return e.setRange(l)},className:"btn btn-sm btn-outline-secondary no-glow".concat(e.range===l?" active":"")},r)}))},Z=new Date;var $=function(e){var t=Object(n.useState)("6 months"),a=Object(h.a)(t,2),r=a[0],l=a[1],s=Object(n.useState)(/Category A/i),o=Object(h.a)(s,2),i=o[0],u=o[1],m=Object(n.useState)("PLAYS"),d=Object(h.a)(m,2),f=d[0],E=d[1],b=Object(n.useState)(!1),g=Object(h.a)(b,2),v=g[0],p=g[1];function y(e,t){var a=e.metrics.weeksSincePlayed,n=t.metrics.weeksSincePlayed;return a="string"===typeof a?9999999:a,n="string"===typeof n?9999999:n,v?n-a:a-n}function j(e,t){return v?e.metrics.plays[r]-t.metrics.plays[r]:t.metrics.plays[r]-e.metrics.plays[r]}var O,N=C("/songs/metrics",{songs:[],count:0}),S=Object(h.a)(N,3),k=S[0].songs,x=S[1],w=S[2],L=(k=function(e){return e.map(function(e){var t,a=e.services;return a.length?((a=a.map(function(e){return new Date(e.date)})).length>1&&(a=a.sort(function(e,t){return Object(z.a)(e,t)})),t=Object(Q.a)(Z,a[0])):t="\u221e",e.metrics.weeksSincePlayed=t,e})}(k)).reduce(function(e,t){return e+t.metrics.plays[r]},0)/k.length;return c.a.createElement("section",{className:"metrics container py-3 relative"},c.a.createElement(M,null,function(e){return c.a.createElement("div",{className:"metric-controls".concat(e?" stuck":"")},c.a.createElement("div",{className:e?"container":""},c.a.createElement(U,{category:i,setCategory:u}),c.a.createElement(X,{range:r,setRange:l})))}),c.a.createElement(_,{loading:w},x&&c.a.createElement("div",{className:"alert alert-danger"},x),c.a.createElement("table",{className:"table songs-table"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Title"),c.a.createElement("th",{className:"text-center sortable",onClick:function(){return"PLAYS"===f?p(!v):E("PLAYS")}},"Plays","PLAYS"===f&&c.a.createElement("i",{className:"ui ".concat(v?"up":"down"," chevron icon ml-2")})),c.a.createElement("th",{className:"text-right sortable",onClick:function(){return"PLAYS"===f?E("WKS"):p(!v)}},"Wks since played","PLAYS"!==f&&c.a.createElement("i",{className:"ui ".concat(v?"down":"up"," chevron icon ml-2")})))),c.a.createElement("tbody",null,(O=k.filter(function(e){return e.tags.find(function(e){return e.match(i)})}),"PLAYS"===f?O.sort(y).sort(j):O.sort(j).sort(y)).map(function(e,t){return c.a.createElement("tr",{key:t,className:e.metrics.plays[r]<L?"text-danger":""},c.a.createElement("td",null,e.title),c.a.createElement("td",{className:"text-center"},e.metrics.plays[r]),c.a.createElement("td",{className:"text-right"},e.metrics.weeksSincePlayed))})))))},ee=(a(73),function(e){return c.a.createElement("footer",null)}),te=(a(74),function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(y,null),c.a.createElement("section",null,c.a.createElement("main",null,c.a.createElement(d.b,{history:E},c.a.createElement(d.a,{path:"/",component:B,exact:!0}),c.a.createElement(d.a,{path:"/services",component:K,exact:!0}),c.a.createElement(d.a,{path:"/metrics",component:$,exact:!0})))),c.a.createElement(ee,null))}}]),t}(c.a.Component));l.a.render(c.a.createElement(te,null),document.querySelector("#root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.6f9f4bf8.chunk.js.map